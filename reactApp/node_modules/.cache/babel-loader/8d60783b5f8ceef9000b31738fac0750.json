{"ast":null,"code":"var _jsxFileName = \"X:\\\\GIT-HUB\\\\link-io\\\\reactApp\\\\src\\\\d3\\\\Timetree.js\";\nimport React, { Component } from 'react';\nimport * as d3 from \"d3\";\nconst red = '#eb6a5b';\nconst green = '#b6e86f';\nconst blue = '#52b6ca'; //const colors = chroma.scale([blue, green, red]);\n\nconst width = document.body.clientWidth;\nconst height = document.body.clientHeight;\nconst margin = {\n  top: 50,\n  right: 50,\n  bottom: 50,\n  left: 100\n};\nconst innerWidth = width - margin.left - margin.right;\nconst innerHeight = height - margin.top - margin.bottom;\n\nclass Timetree extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      treeLayout: d3.tree().size([innerHeight, innerWidth]),\n      descents: [],\n      paths: []\n    };\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    if (!nextProps.data) return null; // data hasn't been loaded yet so do nothing\n\n    const {\n      data\n    } = nextProps;\n    const {\n      treeLayout\n    } = prevState;\n    const root = d3.hierarchy(data);\n    root.descendants().forEach((d, i) => {\n      d.id = i;\n      d._children = d.children;\n      if (d.depth && d.data.status === \"green\") d.children = null;\n    });\n    const links = treeLayout(root).links();\n    const linkPathGenerator = d3.linkHorizontal().x(d => d.y).y(d => d.x);\n    const paths = links.map(d => d.children ? null : linkPathGenerator(d));\n    const descents = root.descendants();\n    return {\n      descents,\n      paths\n    };\n  }\n\n  render() {\n    console.log(\"links data\", this.state.descents);\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"g\", {\n      ref: \"TRANSLATE\",\n      transform: `translate(${margin.left},${margin.top})`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 11\n      }\n    }, this.state.paths.map((d, i) => /*#__PURE__*/React.createElement(\"path\", {\n      key: i,\n      d: d,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 44\n      }\n    })), this.state.descents.map((d, i) => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"text\", {\n      x: d.y,\n      y: d.x,\n      dy: \"0.32em\",\n      textAnchor: d._children ? \"middle\" : \"start\",\n      fontSize: 3.25 - d.depth + 'em',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 13\n      }\n    }, d.data.name)))));\n  }\n\n}\n\nexport default Timetree;","map":{"version":3,"sources":["X:/GIT-HUB/link-io/reactApp/src/d3/Timetree.js"],"names":["React","Component","d3","red","green","blue","width","document","body","clientWidth","height","clientHeight","margin","top","right","bottom","left","innerWidth","innerHeight","Timetree","state","treeLayout","tree","size","descents","paths","getDerivedStateFromProps","nextProps","prevState","data","root","hierarchy","descendants","forEach","d","i","id","_children","children","depth","status","links","linkPathGenerator","linkHorizontal","x","y","map","render","console","log","name"],"mappings":"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","sourcesContent":["import React , {Component } from 'react';\r\nimport * as d3 from \"d3\";\r\n\r\nconst red = '#eb6a5b';\r\nconst green = '#b6e86f';\r\nconst blue = '#52b6ca';\r\n//const colors = chroma.scale([blue, green, red]);\r\nconst width = document.body.clientWidth ;\r\nconst height = document.body.clientHeight ;\r\n\r\nconst margin = { top: 50, right: 50, bottom: 50, left: 100};\r\nconst innerWidth = width - margin.left - margin.right;\r\nconst innerHeight = height - margin.top - margin.bottom;\r\n\r\nclass Timetree extends Component{\r\n  state = {\r\n    treeLayout : d3.tree().size([innerHeight, innerWidth]),\r\n    descents : [],\r\n    paths : [],\r\n  }\r\n  \r\n  static getDerivedStateFromProps(nextProps, prevState) {\r\n    if (!nextProps.data) return null; // data hasn't been loaded yet so do nothing\r\n    const {data} = nextProps;\r\n    const {treeLayout} = prevState;\r\n    const root = d3.hierarchy(data);\r\n    root.descendants().forEach((d, i) => {\r\n           d.id = i;\r\n           d._children = d.children;\r\n           if ( d.depth && d.data.status === \"green\") d.children = null;\r\n          });\r\n    const links = treeLayout(root).links();  \r\n    const linkPathGenerator = d3.linkHorizontal()\r\n           .x(d => d.y)\r\n           .y(d => d.x);\r\n    const paths = links.map(d => d.children? null:linkPathGenerator(d));\r\n    const descents = root.descendants(); \r\n    \r\n\r\n    return {descents , paths};\r\n  }\r\n\r\n  render(){\r\n    console.log(\"links data\", this.state.descents);\r\n    return(\r\n      <>      \r\n          <g ref='TRANSLATE' transform = {`translate(${margin.left},${margin.top})`}>\r\n          {this.state.paths.map((d, i) => (<path key={i} d={d} />))}\r\n          {this.state.descents.map((d, i) => (\r\n            <>\r\n            <text x={d.y} y={d.x} dy=\"0.32em\" textAnchor={d._children ? \"middle\":\"start\"} fontSize = {3.25 - d.depth + 'em'} >\r\n            {d.data.name}\r\n            </text>\r\n            </>\r\n            ))}\r\n          </g>\r\n      </>\r\n      );\r\n  }\r\n}\r\n\r\nexport default Timetree;\r\n\r\n"]},"metadata":{},"sourceType":"module"}